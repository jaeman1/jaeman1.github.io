---
title: "침해사고분석 이론 5"
date: 2024-12-28
categories: [정보보안, 침해사고분석]
tags: [IT, Security]
---

## 루트킷

### 개념

- 루트킷은 컴퓨터 시스템에 침투하여 악의적인 활동을 수행하고, 자신의 존재를 숨기기 위한 악성 소프트웨어입니다.
- 주요 기능:
  - 시스템 권한 획득
  - 사용자 정보 탈취
  - 시스템 제어 및 악성코드 유포
- 특징:
  - 침투 후 자신의 존재를 숨기며 지속적으로 활동
  - 탐지 및 제거가 어려워 공격자에게 지속적인 접근 권한 제공
  - 시스템의 중요한 함수를 후킹하거나 커널 오브젝트를 조작하여 탐지 및 분석 회피

### 종류

1. 커널 루트킷 (Kernel Rootkit)
    - 운영 체제의 커널에 침투하여 동작
    - 시스템에 대한 높은 수준의 접근 권한 획득
2. 사용자 모드 루트킷 (User-mode Rootkit)
    - 사용자 애플리케이션 수준에서 동작
    - API 함수를 후킹하여 정보 가로채기 및 수정
3. 부트킷 (Bootkit)
    - 시스템 부팅 과정을 감염
    - 부팅 전에 실행되어 탐지 및 제거가 매우 어려움
4. 하이퍼바이저 루트킷 (Hypervisor Rootkit)
    - 가상 머신 환경의 하이퍼바이저를 감염
    - 가상 머신의 동작을 제어하고 정보 탈취
5. 펌웨어/하드웨어 루트킷 (Firmware/Hardware Rootkit)
    - 시스템 펌웨어 또는 하드웨어에 침투
    - 탐지 및 제거가 거의 불가능

### 동작 방식

#### 1.시스템 침투

- **취약점 공격**: 시스템 또는 애플리케이션의 취약점을 악용하여 설치
- **소셜 엔지니어링**: 사용자를 속여 악성 파일을 실행하도록 유도
- **악성코드 감염**: 다른 악성코드에 의해 설치

#### 2.권한 획득

- **권한 상승**: 시스템 취약점을 이용하여 관리자 권한 획득
- **패스워드 크래킹**: 사용자 계정 비밀번호를 크래킹하여 권한 획득

#### 3.존재 은닉

- **후킹**: 시스템 함수 또는 API를 변조
- **코드 인젝션**: 악성 코드를 다른 프로세스에 주입
- **파일/프로세스 은닉**: 특정 파일과 프로세스를 숨김
- **레지스트리 수정**: 시스템 설정 변경
- **네트워크 트래픽 변조**: 통신 데이터를 조작하여 탐지 회피

### 탐지 도구

- **파일 무결성 검사 도구**: 설치된 파일의 무결성을 확인
- **메모리 분석 도구**: 메모리 상태를 검사하여 루트킷 탐지
- **네트워크 분석 도구**: 네트워크 트래픽에서 이상 징후 탐지
- **루트킷 탐지 전용 도구**:
  - `chkrootkit`, `rkhunter`

### 분석기술

1. 정적 분석
    - 루트킷 파일을 실행하지 않고 코드 분석
    - 예: 바이너리 파일의 구조 및 코드 분석

2. 동적 분석
    - 루트킷을 가상 환경에서 실행하여 행위 분석
    - 예: 시스템 변화 및 네트워크 통신 모니터링

3. 시스템 로그 분석
    - 시스템 로그에서 루트킷 관련 의심스러운 이벤트 탐지

4. 메모리 포렌식
    - 시스템 메모리 스냅샷을 분석하여 루트킷의 프로세스, 코드, 데이터를 식별
